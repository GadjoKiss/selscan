selscan -- a program to calculate EHH-based scans for positive selection in 
	genomes.

Copyright (C) 2014  Zachary A Szpiech

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.
   
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
   
You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA

Source code and binaries can be found at 
	https://www.github.com/szpiech/selscan

selscan currently implements EHH, iHS, and XP-EHH.

Citations:

ZA Szpiech and RD Hernandez (2014) selscan: an efficient multi-threaded program 
	to calculate EHH-based scans for positive selection. arXiv:1403.6854 [q-bio.PE]
PC Sabeti, et al. (2007) Genome-wide detection and characterization of positive 
	selection in human populations. Nature, 449: 913–918.
BF Voight, et al. (2006) A map of recent positive selection in the human 
	genome. PLoS Biology, 4: e72.
PC Sabeti, et al. (2002) Detecting recent positive selection in the human 
	genome from haplotype structure. Nature, 419: 832–837.

To calculate EHH:

./selscan --ehh <locusID> --hap <haplotypes> --map <mapfile> --out <outfile>

Output file: <outfile>.ehh.<locusID>[.alt].out
Format: <physicalPos> <geneticPos> <'1' EHH> <'0' EHH>

To calculate iHS:

./selscan --ihs --hap <haplotypes> --map <mapfile> --out <outfile>

Output file: <outfile>.ihs[.alt].out
Format: <locusID> <physicalPos> <'1' freq> <ihh1> <ihh0> <unstandardized iHS>

To calculate XP-EHH:

./selscan --xpehh --hap <pop1 haplotypes> --ref <pop2 haplotypes> --map <mapfile> --out <outfile>

Output file: <outfile>.ihs[.alt].out
Format: <locusID> <physicalPos> <geneticPos> <popA '1' freq> <ihhA> <popB '1' freq> <ihhB> <unstandardized XPEHH>

Examples:

selscan --ihs --hap example.hap --map example.map --out example
selscan --ehh Locus4077 --hap example.hap --map example.map --out example
selscan --xpehh --hap example2.pop1.hap --ref example2.pop2.hap --map example2.map --out example2

----------Command Line Arguments----------

--hap <string>: A hapfile with one row per individual, and one column per 
	variant.  Variants should be coded 0/1/-9.
	Default: __hapfile1

--map <string>: A mapfile with one row per variant site.  
	Formatted <chr#> <locusID> <genetic pos> <physical pos>. 
	Default: __mapfile

--ref <string>: A hapfile with one row per individual, and one column per 
	variant.  Variants should be coded 0/1/-9. 	This is the 'reference' 
	population for XP-EHH calculations.  Ignored otherwise.
	Default: __hapfile2

--out <string>: The basename for all output files.
	Default: outfile

--ehh <string>: Calculate EHH of the '1' and '0' haplotypes at the specified 
	locus.  Output: <physical dist> <genetic dist> <'1' EHH> <'0' EHH> 
	Default: __NO_LOCUS__

--ihs <bool>: Set this flag to calculate iHS. 
	Default: false

--xpehh <bool>: Set this flag to calculate XP-EHH.
	Default: false

--ehh-win <int>: When calculating EHH, this is the length of the window in bp 
	in each direction from the query locus.
	Default: 100000

--cutoff <double>: The EHH decay cutoff.
	Default: 0.05

--gap-scale <int>: Gap scale parameter in bp.
	If a gap is encountered between two snps > GAP_SCALE and < MAX_GAP, then 
	the genetic distance is scaled by GAP_SCALE/GAP.
	Default: 20000

--maf <double>: If a site has a MAF below this value, the program will not use 
	it as a core snp.
	Default: 0.05

--max-gap <int>: Maximum allowed gap in bp between two snps.
	Default: 200000

--threads <int>: The number of threads to spawn during the calculation.  
	Partitions loci across threads.
	Default: 1

--alt <bool>: Set this flag to calculate homozygosity based on haplotype 
	frequencies in the observed data. 
	Default: false

--help <bool>: Prints this help dialog.
	Default: false

################################################################################
################################################################################

norm -- a program for downstream analysis of selscan output
Source code and binaries can be found at
	<https://www.github.com/szpiech/selscan>

norm currently analyzes iHS output only at this time.

Citations:

ZA Szpiech and RD Hernandez (2014) arXiv:1403.6854 [q-bio.PE]
BF Voight, et al. (2006) PLoS Biology, 4: e72.

To normalize iHS output across frequency bins:

./norm --files <file1.ihs.out> ... <fileN.ihs.out>

To normalize iHS output and analyze non-overlapping windows of fixed bp for 
extreme iHS scores:

./norm --files <file1.ihs.out> ... <fileN.ihs.out> --bp-win

----------Command Line Arguments----------

--bins <int>: The number of frequency bins in [0,1] for score normalization.
	Default: 100

--bp-win <bool>: If set, will use windows of a constant bp size with varying
	number of SNPs.
	Default: false

--files <string1> ... <stringN>: A list of files delimited by whitespace for
	joint normalization.
	Expected format: <locus name> <physical pos> <freq> <ihh1> <ihh2> <ihs>
	Default: infile

--first <bool>: Output only the first file's normalization.
	Default: false

--help <bool>: Prints this help dialog.
	Default: false

--log <string>: The log file name.
	Default: logfile

--min-snps <int>: Only consider a bp window if it has at least this many SNPs.
	Default: 10

--qbins <int>: Outlying windows are binned by number of sites within each
	window.  This is the number of quantile bins to use.
	Default: 20

--snp-win <bool>: <not implemented> If set, will use windows of a constant
	SNP size with varying bp length.
	Default: false

--snp-win-size <int>: <not implemented> The number of SNPs in a window.
	Default: 50

--winsize <int>: The non-overlapping window size for calculating the percentage
	of extreme SNPs.
	Default: 100000
